# Troubleshooting

## Не запускается elasticsearch 
После выполнения ```service elasticsearch start``` не запустился сервер. Вариантов может быть несколько:
* Для начала нужно точно убедится что elasticsearch остановлен ```service elasticsearch status``` или ```ps ax | grep elasticsearch```
* Ошибка после старта elasticsearch, можно посмотреть в логи в таком порядке:
	* ```journalctl -u elasticsearch --no-pager```
	* Основной лог /var/log/elasticsearch/elasticsearch.log	или /var/log/elasticsearch/[имя_кластера].log, где [имя_кластера] значение ноды конфига ```cluster.name```
	* Другие в /var/log/elasticsearch/*.log	
	* Если elasticsearch убил OOM killer, то логи нужно искать в общем логе системы. В случае с debian /var/log/messages

## Не собирается кластер
Бывает такое что сервера запущены и по отдельности доступны на нескольких нодах, но не видят друг друга и не собираются в кластер. Причин может быть несколько:
* Запустили сервер без конфигурации для кластера, а после переконфигурировали в качестве ведомой ноды для подключения к уже существующему кластеру. В этом случае elasticsearch не знает какой статус у ноды и не может ее принять в кластер, т.к. новая нода думает что она является частью самостоятельного кластера. В этом случае помогает остановка сервера ```service elasticsearch stop``` и удаление файлов данных ```rm -fr /var/lib/elasticsearch/nodes/*```, это способ годится только если вы на 100% уверены что нода не содежит данных и ее нужно просто присоеденить к кластеру. Такая проблема возникает только при первоначальном сборе кластера. Либо при копировании ВМ.
* Ноды не видят друг друга из за сетевых ограничений
* Ошибка в конфигурации. Проверьте имена кластеров ноды конфига:
	* ```cluster.initial_master_nodes``` - должна быть одинакова на всех серверах кластера
	* ```node.name``` - имя ноды должно быть уникальным для кластера на каждой отдельной ноде
	* ```cluster.name``` - имя кластера должно быть одинаковым на всех нодах кластера